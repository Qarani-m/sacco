<div class="page-header">
    <h1 class="page-title">Notifications</h1>
    <% if (unread_count > 0) { %>
        <div>
            <button onclick="markAllRead()" style="padding: 0.5rem 1rem; background: #2563EB; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.875rem;">Mark All Read</button>
        </div>
    <% } %>
</div>

<div class="card">
    <% if (notifications && notifications.length > 0) { %>
        <div style="display: flex; flex-direction: column; gap: 1rem;">
            <% notifications.forEach(notification => { %>
                <div style="
                    padding: 1rem;
                    border-left: 4px solid <%= !notification.is_read ? '#2563EB' : '#E5E7EB' %>;
                    background: <%= !notification.is_read ? '#EFF6FF' : '#F9FAFB' %>;
                    border-radius: 4px;
                ">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <span style="
                                    padding: 2px 8px;
                                    border-radius: 10px;
                                    font-size: 0.75rem;
                                    font-weight: 600;
                                    background: #DBEAFE;
                                    color: #1E40AF;
                                "><%= notification.type.replace('_', ' ') %></span>
                                <span style="font-size: 0.75rem; color: #6B7280;">
                                    <%= new Date(notification.created_at).toLocaleString() %>
                                </span>
                            </div>
                            <h3 style="margin: 0 0 0.5rem 0; font-size: 1rem; font-weight: 600; color: #111827;">
                                <%= notification.title %>
                            </h3>
                            <p style="margin: 0; color: #4B5563; font-size: 0.875rem;">
                                <%= notification.message %>
                            </p>
                            <% if (notification.related_entity_type && notification.related_entity_id) { %>
                                <a href="/admin/<%= notification.related_entity_type %>s/<%= notification.related_entity_id %>"
                                   style="display: inline-block; margin-top: 0.5rem; color: #2563EB; text-decoration: none; font-size: 0.875rem;">
                                    View Details â†’
                                </a>
                            <% } %>
                        </div>
                        <% if (!notification.is_read) { %>
                            <button onclick="markRead('<%= notification.id %>')"
                                    style="padding: 0.25rem 0.75rem; background: white; border: 1px solid #E5E7EB; border-radius: 4px; cursor: pointer; font-size: 0.75rem; color: #6B7280;">
                                Mark Read
                            </button>
                        <% } %>
                    </div>
                </div>
            <% }); %>
        </div>
    <% } else { %>
        <div style="text-align: center; padding: 3rem;">
            <div style="font-size: 3rem; color: #E5E7EB; margin-bottom: 1rem;">ðŸ””</div>
            <p style="color: #6B7280; font-size: 1rem;">No notifications yet</p>
        </div>
    <% } %>
</div>

<script>
async function markRead(notificationId) {
    try {
        const response = await fetch(`/admin/notifications/${notificationId}/read`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });

        if (response.ok) {
            location.reload();
        }
    } catch (error) {
        console.error('Error marking notification as read:', error);
    }
}

async function markAllRead() {
    // Implement mark all read functionality
    alert('Mark all read functionality - to be implemented');
}
</script>
